"use client"

import { useState } from 'react'

const PageStates = {
    Overview: 1,
    CoreFoundations: 2
}

export default function JavaSecurityPage() {
    const [pageState, setPageState] = useState(PageStates.Overview)

    return (
        <div className="pt-4">
            <div className="d-flex gap-2 mb-3">
                <button
                    className={`btn ${pageState === PageStates.Overview ? 'btn-primary' : 'btn-outline-primary'}`}
                    onClick={() => setPageState(PageStates.Overview)}
                >
                    Overview
                </button>
                <button
                    className={`btn ${pageState === PageStates.CoreFoundations ? 'btn-primary' : 'btn-outline-primary'}`}
                    onClick={() => setPageState(PageStates.CoreFoundations)}
                >
                    Core Foundations
                </button>
            </div>

            {pageState === PageStates.Overview && (
                <div className="card mb-4 shadow-sm">
                    <div className="card-body">
                        <h2 className="card-title mb-3">Java Security - Overview</h2>

                        <div className="row">
                        <div className="col-md-6">
                            <h5>Core Security Components</h5>
                            <ul className="list-group list-group-flush mb-3">
                                <li className="list-group-item"><strong>Java Cryptography Architecture (JCA):</strong> Framework for encryption, key generation, digital signatures</li>
                                <li className="list-group-item"><strong>Java Cryptography Extension (JCE):</strong> APIs for encryption, key exchange, MAC</li>
                                <li className="list-group-item"><strong>Java Secure Socket Extension (JSSE):</strong> SSL/TLS implementation</li>
                                <li className="list-group-item"><strong>Java Authentication and Authorization Service (JAAS):</strong> User authentication and access control</li>
                                <li className="list-group-item"><strong>Security Manager:</strong> Runtime permissions and access control</li>
                            </ul>
                        </div>

                        <div className="col-md-6">
                            <h5>Common Security Practices</h5>
                            <ul className="list-group list-group-flush mb-3">
                                <li className="list-group-item"><strong>Input Validation:</strong> Sanitize all user inputs to prevent injection attacks</li>
                                <li className="list-group-item"><strong>SQL Injection Prevention:</strong> Use PreparedStatement with parameterized queries</li>
                                <li className="list-group-item"><strong>XSS Prevention:</strong> Encode output, use content security policies</li>
                                <li className="list-group-item"><strong>CSRF Protection:</strong> Use anti-CSRF tokens in forms</li>
                                <li className="list-group-item"><strong>Secure Password Storage:</strong> Use BCrypt, PBKDF2, or Argon2</li>
                            </ul>
                        </div>
                    </div>

                    <div className="row mt-4">
                        <div className="col-md-6">
                            <h5>Cryptography in Java</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>MessageDigest:</strong> SHA-256, SHA-512 for hashing</li>
                                <li className="list-group-item"><strong>Cipher:</strong> AES, RSA for encryption/decryption</li>
                                <li className="list-group-item"><strong>KeyGenerator:</strong> Generate symmetric keys</li>
                                <li className="list-group-item"><strong>KeyPairGenerator:</strong> Generate public/private key pairs</li>
                                <li className="list-group-item"><strong>Signature:</strong> Digital signatures with RSA, DSA, ECDSA</li>
                                <li className="list-group-item"><strong>SecureRandom:</strong> Cryptographically strong random number generation</li>
                            </ul>
                        </div>

                        <div className="col-md-6">
                            <h5>SSL/TLS Configuration</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>SSLContext:</strong> Configure SSL/TLS protocols and cipher suites</li>
                                <li className="list-group-item"><strong>KeyStore:</strong> Store private keys and certificates</li>
                                <li className="list-group-item"><strong>TrustStore:</strong> Store trusted CA certificates</li>
                                <li className="list-group-item"><strong>TLS Versions:</strong> Use TLS 1.2+ (avoid SSL, TLS 1.0/1.1)</li>
                                <li className="list-group-item"><strong>Certificate Validation:</strong> Implement proper hostname verification</li>
                            </ul>
                        </div>
                    </div>

                    <div className="row mt-4">
                        <div className="col-md-6">
                            <h5>Authentication & Authorization</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>JAAS LoginModule:</strong> Pluggable authentication modules</li>
                                <li className="list-group-item"><strong>Spring Security:</strong> Comprehensive authentication/authorization framework</li>
                                <li className="list-group-item"><strong>JWT Tokens:</strong> Stateless authentication with JSON Web Tokens</li>
                                <li className="list-group-item"><strong>OAuth 2.0:</strong> Delegated authorization protocol</li>
                                <li className="list-group-item"><strong>OpenID Connect:</strong> Identity layer on top of OAuth 2.0</li>
                                <li className="list-group-item"><strong>LDAP/Active Directory:</strong> Enterprise user directories</li>
                            </ul>
                        </div>

                        <div className="col-md-6">
                            <h5>Secure Coding Guidelines</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>Least Privilege:</strong> Grant minimum necessary permissions</li>
                                <li className="list-group-item"><strong>Fail Securely:</strong> Handle errors without exposing sensitive info</li>
                                <li className="list-group-item"><strong>Defense in Depth:</strong> Multiple layers of security controls</li>
                                <li className="list-group-item"><strong>Avoid Security by Obscurity:</strong> Don't rely on hidden implementation</li>
                                <li className="list-group-item"><strong>Keep Security Simple:</strong> Complex systems have more vulnerabilities</li>
                                <li className="list-group-item"><strong>Regular Updates:</strong> Keep dependencies and JDK up to date</li>
                            </ul>
                        </div>
                    </div>

                    <div className="row mt-4">
                        <div className="col-md-6">
                            <h5>Common Vulnerabilities (OWASP Top 10)</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>Broken Access Control:</strong> Unauthorized access to resources</li>
                                <li className="list-group-item"><strong>Cryptographic Failures:</strong> Weak encryption, exposed data</li>
                                <li className="list-group-item"><strong>Injection:</strong> SQL, LDAP, XML injection attacks</li>
                                <li className="list-group-item"><strong>Insecure Design:</strong> Lack of security controls in design phase</li>
                                <li className="list-group-item"><strong>Security Misconfiguration:</strong> Default credentials, verbose errors</li>
                                <li className="list-group-item"><strong>Vulnerable Components:</strong> Outdated libraries with known CVEs</li>
                            </ul>
                        </div>

                        <div className="col-md-6">
                            <h5>Security Tools & Libraries</h5>
                            <ul className="list-group list-group-flush">
                                <li className="list-group-item"><strong>OWASP Dependency-Check:</strong> Identify vulnerable dependencies</li>
                                <li className="list-group-item"><strong>Snyk:</strong> Continuous security scanning</li>
                                <li className="list-group-item"><strong>SonarQube:</strong> Static code analysis for security issues</li>
                                <li className="list-group-item"><strong>Checkmarx/Fortify:</strong> Application security testing</li>
                                <li className="list-group-item"><strong>Bouncy Castle:</strong> Additional cryptographic algorithms</li>
                                <li className="list-group-item"><strong>Apache Shiro:</strong> Lightweight security framework</li>
                            </ul>
                        </div>
                    </div>

                    <div className="row mt-4">
                        <div className="col-12">
                            <h5>Security Best Practices by Context</h5>
                            <div className="table-responsive">
                                <table className="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Context</th>
                                            <th>Best Practice</th>
                                            <th>Implementation</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>Password Storage</strong></td>
                                            <td>Use strong hashing with salt</td>
                                            <td>BCryptPasswordEncoder, PBKDF2, Argon2</td>
                                        </tr>
                                        <tr>
                                            <td><strong>API Communication</strong></td>
                                            <td>Always use HTTPS/TLS</td>
                                            <td>SSL/TLS 1.2+, certificate pinning</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Database Access</strong></td>
                                            <td>Use parameterized queries</td>
                                            <td>PreparedStatement, JPA/Hibernate</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Session Management</strong></td>
                                            <td>Secure session cookies</td>
                                            <td>HttpOnly, Secure, SameSite flags</td>
                                        </tr>
                                        <tr>
                                            <td><strong>File Upload</strong></td>
                                            <td>Validate file type and size</td>
                                            <td>Content-Type validation, virus scanning</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Error Handling</strong></td>
                                            <td>Don't expose stack traces</td>
                                            <td>Generic error messages, log internally</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Logging</strong></td>
                                            <td>Don't log sensitive data</td>
                                            <td>Mask PII, passwords, tokens in logs</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div className="row mt-4">
                        <div className="col-md-6">
                            <h5>Java Security Manager (Legacy)</h5>
                            <ul className="list-unstyled">
                                <li className="mb-2"><strong>Note:</strong> Deprecated for removal in future Java versions</li>
                                <li className="mb-2"><strong>Purpose:</strong> Define fine-grained permissions for code</li>
                                <li className="mb-2"><strong>Policy Files:</strong> Specify access rights to resources</li>
                                <li className="mb-2"><strong>Modern Alternative:</strong> Use containerization and OS-level security</li>
                            </ul>
                        </div>

                        <div className="col-md-6">
                            <h5>Security Compliance</h5>
                            <ul className="list-unstyled">
                                <li className="mb-2"><strong>GDPR:</strong> Data protection and privacy requirements</li>
                                <li className="mb-2"><strong>PCI DSS:</strong> Payment card industry data security</li>
                                <li className="mb-2"><strong>HIPAA:</strong> Healthcare information protection</li>
                                <li className="mb-2"><strong>SOC 2:</strong> Service organization controls</li>
                                <li className="mb-2"><strong>ISO 27001:</strong> Information security management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            )}

            {pageState === PageStates.CodeExamples && (
                <div className="card mb-4 shadow-sm">
                    <div className="card-body">
                        <h2 className="card-title mb-3">Java Security - Code Examples</h2>

                        <div className="row">
                            <div className="col-md-6">
                                <h5>Password Hashing with BCrypt</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Using BCrypt for password hashing
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
String rawPassword = "mySecurePassword123";
String hashedPassword = encoder.encode(rawPassword);

// Verify password
boolean matches = encoder.matches(rawPassword, hashedPassword);`}</code>
                                </pre>
                            </div>

                            <div className="col-md-6">
                                <h5>AES Encryption/Decryption</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// AES encryption example
import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;

KeyGenerator keyGen = KeyGenerator.getInstance("AES");
keyGen.init(256);
SecretKey secretKey = keyGen.generateKey();

Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
cipher.init(Cipher.ENCRYPT_MODE, secretKey);
byte[] encrypted = cipher.doFinal("Hello".getBytes());

cipher.init(Cipher.DECRYPT_MODE, secretKey);
byte[] decrypted = cipher.doFinal(encrypted);`}</code>
                                </pre>
                            </div>
                        </div>

                        <div className="row mt-4">
                            <div className="col-md-6">
                                <h5>SQL Injection Prevention</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// BAD - Vulnerable to SQL injection
String query = "SELECT * FROM users WHERE username='" 
    + username + "'";
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(query);

// GOOD - Using PreparedStatement
String query = "SELECT * FROM users WHERE username=?";
PreparedStatement pstmt = conn.prepareStatement(query);
pstmt.setString(1, username);
ResultSet rs = pstmt.executeQuery();`}</code>
                                </pre>
                            </div>

                            <div className="col-md-6">
                                <h5>JWT Token Generation</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Using jjwt library
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;

String token = Jwts.builder()
    .setSubject(username)
    .setIssuedAt(new Date())
    .setExpiration(new Date(System.currentTimeMillis() 
        + 86400000)) // 24 hours
    .signWith(SignatureAlgorithm.HS512, secretKey)
    .compact();

// Validate token
Claims claims = Jwts.parser()
    .setSigningKey(secretKey)
    .parseClaimsJws(token)
    .getBody();`}</code>
                                </pre>
                            </div>
                        </div>

                        <div className="row mt-4">
                            <div className="col-md-6">
                                <h5>SSL/TLS Configuration</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Configure SSLContext
import javax.net.ssl.*;
import java.security.KeyStore;

KeyStore keyStore = KeyStore.getInstance("JKS");
keyStore.load(new FileInputStream("keystore.jks"), 
    "password".toCharArray());

KeyManagerFactory kmf = KeyManagerFactory
    .getInstance(KeyManagerFactory.getDefaultAlgorithm());
kmf.init(keyStore, "password".toCharArray());

SSLContext sslContext = SSLContext.getInstance("TLSv1.3");
sslContext.init(kmf.getKeyManagers(), null, null);

SSLSocketFactory factory = sslContext.getSocketFactory();`}</code>
                                </pre>
                            </div>

                            <div className="col-md-6">
                                <h5>Secure Random Generation</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Generate cryptographically secure random values
import java.security.SecureRandom;

SecureRandom secureRandom = new SecureRandom();

// Generate random bytes for salt
byte[] salt = new byte[16];
secureRandom.nextBytes(salt);

// Generate random token
String token = new BigInteger(130, secureRandom)
    .toString(32);

// Generate random int
int randomInt = secureRandom.nextInt(1000);`}</code>
                                </pre>
                            </div>
                        </div>

                        <div className="row mt-4">
                            <div className="col-md-6">
                                <h5>Input Validation</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Using Bean Validation (JSR 303)
import javax.validation.constraints.*;

public class UserDTO {
    @NotBlank(message = "Username is required")
    @Size(min = 3, max = 20)
    @Pattern(regexp = "^[a-zA-Z0-9_]+$")
    private String username;
    
    @Email(message = "Invalid email format")
    private String email;
    
    @NotNull
    @Size(min = 8, message = "Password must be 8+ chars")
    private String password;
}`}</code>
                                </pre>
                            </div>

                            <div className="col-md-6">
                                <h5>CSRF Protection (Spring Security)</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Spring Security CSRF configuration
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) 
            throws Exception {
        http
            .csrf(csrf -> csrf
                .csrfTokenRepository(
                    CookieCsrfTokenRepository.withHttpOnlyFalse()
                )
            )
            .authorizeHttpRequests(auth -> auth
                .anyRequest().authenticated()
            );
        return http.build();
    }
}`}</code>
                                </pre>
                            </div>
                        </div>

                        <div className="row mt-4">
                            <div className="col-12">
                                <h5>Spring Security Complete Configuration</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`@Configuration
@EnableWebSecurity
public class SecurityConfiguration {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/public/**").permitAll()
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .sessionManagement(session -> session
                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            )
            .csrf(csrf -> csrf.disable()) // For stateless REST APIs
            .cors(cors -> cors.configurationSource(corsConfigurationSource()))
            .addFilterBefore(jwtAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class)
            .exceptionHandling(ex -> ex
                .authenticationEntryPoint(new HttpStatusEntryPoint(HttpStatus.UNAUTHORIZED))
            );
        
        return http.build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) 
            throws Exception {
        return config.getAuthenticationManager();
    }
}`}</code>
                                </pre>
                            </div>
                        </div>

                        <div className="row mt-4">
                            <div className="col-md-6">
                                <h5>File Upload Validation</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Secure file upload handling
import org.apache.tika.Tika;

public void validateFile(MultipartFile file) {
    // Check file size
    if (file.getSize() > 10 * 1024 * 1024) { // 10MB
        throw new IllegalArgumentException("File too large");
    }
    
    // Validate file type using Apache Tika
    Tika tika = new Tika();
    String mimeType = tika.detect(file.getInputStream());
    
    List<String> allowed = Arrays.asList(
        "image/jpeg", "image/png", "application/pdf"
    );
    
    if (!allowed.contains(mimeType)) {
        throw new IllegalArgumentException("Invalid file type");
    }
    
    // Sanitize filename
    String filename = file.getOriginalFilename();
    filename = filename.replaceAll("[^a-zA-Z0-9._-]", "_");
}`}</code>
                                </pre>
                            </div>

                            <div className="col-md-6">
                                <h5>Secure Cookie Configuration</h5>
                                <pre className="bg-light p-3 rounded">
                                    <code>{`// Setting secure cookies
import javax.servlet.http.Cookie;

public Cookie createSecureCookie(String name, String value) {
    Cookie cookie = new Cookie(name, value);
    cookie.setHttpOnly(true);  // Prevent XSS
    cookie.setSecure(true);    // HTTPS only
    cookie.setPath("/");
    cookie.setMaxAge(3600);    // 1 hour
    cookie.setAttribute("SameSite", "Strict"); // CSRF protection
    
    return cookie;
}

// In Spring Boot application.properties
// server.servlet.session.cookie.http-only=true
// server.servlet.session.cookie.secure=true
// server.servlet.session.cookie.same-site=strict`}</code>
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>
            )}
        </div>
    )
}
